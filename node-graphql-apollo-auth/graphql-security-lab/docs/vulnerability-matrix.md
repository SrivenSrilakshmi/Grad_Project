# Vulnerability Matrix

This file maps each insecure pattern in the vulnerable server to the mitigation used in the hardened server and links to best-practice docs.

- No depth limit
  - Mitigation: graphql-depth-limit
  - Docs: https://github.com/stems/graphql-depth-limit

- No complexity analysis
  - Mitigation: graphql-query-complexity
  - Docs: https://github.com/squareeyed/graphql-query-complexity

- Introspection enabled in production
  - Mitigation: disable introspection via server config when NODE_ENV=production
  - Docs: Apollo Server security notes

- Raw SQL / concatenation
  - Mitigation: Use parameterized queries or an ORM (Prisma/Knex)

- Missing resolver auth
  - Mitigation: resolver-level checks and middleware; verify JWTs

- No input validation
  - Mitigation: zod/joi validation on resolver inputs

- No rate limiting
  - Mitigation: express-rate-limit and monitoring on GraphQL operations

Defender checklist (quick)

1. Add depth limiting and complexity analysis
2. Use persisted queries for public clients
3. Enforce resolver-level auth checks and role-based controls
4. Use parameterized DB queries / ORM
5. Validate inputs with zod/joi
6. Add rate limiting and monitoring
7. Disable introspection in production
